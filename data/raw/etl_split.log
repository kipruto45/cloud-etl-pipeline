2026-01-31 13:35:51,693 - INFO - ================================================================================
2026-01-31 13:35:51,694 - INFO - ETL PIPELINE: Normalizing car_prices.csv
2026-01-31 13:35:51,694 - INFO - ================================================================================
2026-01-31 13:35:51,695 - INFO - Step 1: Loading data/raw/car_prices.csv...
2026-01-31 13:35:53,909 - INFO - ✓ Loaded 558,837 rows, 16 columns
2026-01-31 13:35:53,910 - INFO -   Columns: year, make, model, trim, body, transmission, vin, state, condition, odometer, color, interior, seller, mmr, sellingprice, saledate
2026-01-31 13:35:53,910 - INFO - ✓ Standardized column names to snake_case
2026-01-31 13:35:53,910 - INFO - 
Step 2: Validating data types...
2026-01-31 13:35:53,917 - INFO - ✓ Converted 3 numeric columns
2026-01-31 13:37:19,102 - INFO - ================================================================================
2026-01-31 13:37:19,110 - INFO - ETL PIPELINE: Normalizing car_prices.csv
2026-01-31 13:37:19,110 - INFO - ================================================================================
2026-01-31 13:37:19,110 - INFO - Step 1: Loading data/raw/car_prices.csv...
2026-01-31 13:37:21,013 - INFO - ✓ Loaded 558,837 rows, 16 columns
2026-01-31 13:37:21,013 - INFO -   Columns: year, make, model, trim, body, transmission, vin, state, condition, odometer, color, interior, seller, mmr, sellingprice, saledate
2026-01-31 13:37:21,014 - INFO - ✓ Standardized column names to snake_case
2026-01-31 13:37:21,014 - INFO - 
Step 2: Validating data types...
2026-01-31 13:37:21,021 - INFO - ✓ Converted 3 numeric columns
2026-01-31 13:42:42,579 - INFO - ================================================================================
2026-01-31 13:42:42,580 - INFO - ETL PIPELINE: Normalizing car_prices.csv
2026-01-31 13:42:42,581 - INFO - ================================================================================
2026-01-31 13:42:42,581 - INFO - Step 1: Loading data/raw/car_prices.csv...
2026-01-31 13:42:44,747 - INFO - ✓ Loaded 558,837 rows, 16 columns
2026-01-31 13:42:44,747 - INFO -   Columns: year, make, model, trim, body, transmission, vin, state, condition, odometer, color, interior, seller, mmr, sellingprice, saledate
2026-01-31 13:42:44,748 - INFO - ✓ Standardized column names to snake_case
2026-01-31 13:42:44,748 - INFO - 
Step 2: Validating data types...
2026-01-31 13:42:44,756 - INFO - ✓ Converted 3 numeric columns
2026-01-31 13:42:45,315 - INFO - ✓ Converted saledate to datetime format (UTC)
2026-01-31 13:42:45,316 - INFO - 
Data Quality Check:
2026-01-31 13:42:45,317 - INFO -   odometer: 94 null values (0.02%)
2026-01-31 13:42:45,319 - INFO -   mmr: 38 null values (0.01%)
2026-01-31 13:42:45,320 - INFO -   sellingprice: 12 null values (0.00%)
2026-01-31 13:42:45,322 - INFO -   saledate: 33 null values (0.01%)
2026-01-31 13:42:45,323 - INFO -   condition: 11,820 null values (2.12%)
2026-01-31 13:42:45,324 - INFO - 
Step 3: Extracting dealers reference table...
2026-01-31 13:42:45,372 - INFO - ✓ Extracted 14,263 unique dealers
2026-01-31 13:42:45,485 - INFO - 
Step 4: Extracting cars reference table...
2026-01-31 13:42:46,471 - INFO - ✓ Extracted 554,641 unique vehicles
2026-01-31 13:42:46,538 - INFO -   Top 5 makes: {'Ford': 92947, 'Chevrolet': 59695, 'Nissan': 53709, 'Toyota': 39606, 'Dodge': 30447}
2026-01-31 13:42:48,045 - INFO - 
Step 5: Extracting sales transaction table...
2026-01-31 13:42:48,219 - INFO - ✓ Extracted 558,837 sales transactions
2026-01-31 13:42:48,224 - INFO -   Date range: 2014-01-01 01:15:00+00:00 to 9900-01-01 00:00:00+00:00
2026-01-31 13:42:48,227 - INFO -   Avg price: $13611.36
2026-01-31 13:42:48,233 - INFO -   Price range: $1.00 - $230000.00
2026-01-31 13:42:48,233 - INFO - 
Step 6: Validating referential integrity...
2026-01-31 13:42:48,254 - INFO -   Invalid car_id references: 0
2026-01-31 13:42:48,254 - INFO -   Invalid dealer_id references: 0
2026-01-31 13:42:48,255 - INFO - ✓ Referential integrity validated
2026-01-31 13:42:48,255 - INFO - 
Step 7: Writing output files...
2026-01-31 13:42:48,276 - INFO - ✓ Saved dealers.csv (14,263 rows)
2026-01-31 13:42:50,380 - INFO - ✓ Saved cars.csv (554,641 rows)
2026-01-31 13:42:56,352 - INFO - ✓ Saved sales.csv (558,837 rows)
2026-01-31 13:42:56,352 - INFO - 
================================================================================
2026-01-31 13:42:56,352 - INFO - ETL PIPELINE SUMMARY
2026-01-31 13:42:56,352 - INFO - ================================================================================
2026-01-31 13:42:56,353 - INFO - Input: car_prices.csv (558,837 rows)
2026-01-31 13:42:56,353 - INFO - 
Output Tables (3NF Normalized):
2026-01-31 13:42:56,353 - INFO -   1. dealers.csv
2026-01-31 13:42:56,353 - INFO -      - Rows: 14,263
2026-01-31 13:42:56,353 - INFO -      - Primary Key: dealer_id
2026-01-31 13:42:56,353 - INFO -      - Columns: dealer_id, dealer_name
2026-01-31 13:42:56,353 - INFO - 
  2. cars.csv
2026-01-31 13:42:56,354 - INFO -      - Rows: 554,641
2026-01-31 13:42:56,354 - INFO -      - Primary Key: car_id
2026-01-31 13:42:56,354 - INFO -      - Columns: car_id, year, make, model, trim, body, transmission, vin, color, interior
2026-01-31 13:42:56,354 - INFO - 
  3. sales.csv
2026-01-31 13:42:56,354 - INFO -      - Rows: 558,837
2026-01-31 13:42:56,354 - INFO -      - Primary Key: sale_id
2026-01-31 13:42:56,354 - INFO -      - Foreign Keys: car_id (→ cars.car_id), dealer_id (→ dealers.dealer_id)
2026-01-31 13:42:56,355 - INFO -      - Columns: sale_id, car_id, dealer_id, state, condition, odometer, mmr, selling_price, sale_date
2026-01-31 13:42:56,355 - INFO - 
✓ ETL pipeline completed successfully!
2026-01-31 13:42:56,355 - INFO - ================================================================================
